# 新增、更新和刪除資料 

### 使用Management Studio編輯 記錄資料-圖例 

以【教務系統】資料庫的【課程】資料表為例， 在「物件總管」視窗展開【教務系統】資料庫，選【課程】 資料表，
在資料表上執行【右】鍵快顯功能表的 【編輯前200個資料列】指令，可以看到每一列 為一筆記錄的編輯視窗 。 


# 新增記錄 

### INSERT 指令

* INSERT指令可以新增一筆記錄到資料表，其基本語法如下所示： 
```
INSERT [INTO] 資料表名稱 [(欄位清單)] 
[DEFAULT] VALUES (欄位值清單) 
```

不使用欄位清單在【學生】資料表新增一筆學生 記錄，如下所示： 
```
INSERT INTO 學生  VALUES ('S108','令弧沖','男',
                          '02-23111122','1996/05/03') 
```

使用欄位清單在【課程】資料表新增一筆課程記錄，如下所示： 
```
INSERT INTO 課程 (課程編號, 名稱, 學分) 
VALUES ('CS410','平行程式設計',2) 
```

* 記錄建構子（Row Constructors）可以在同一個 INSERT指令的VALUES子句插入多筆記錄

在【員工】資料表使用記錄建構子來同時新增2筆 員工記錄，如下所示： 
```
INSERT INTO 員工 (身份證字號, 姓名, 城市, 街道, 電話, 薪水, 保險, 扣稅)  
VALUES  
('K221234566','白開心','嘉義','中正路',
    '06-55555555', 26000, 500, 560),
('K123456789','王火山','基隆','中山路',
    '02-34567890', 26000, 500, 560) 
```


### INSERT/SELECT指令

* INSERT/SELECT指令可以將其他資料表查詢結果的記錄，新增至資料表，它可以同時新增多筆記錄，其基本語法如下所示：
```
INSERT [INTO] 資料表名稱 [(欄位清單)] 
SELECT指令敘述 
```

* INSERT/SELECT指令是使用SELECT子查詢來取代VALUES子句，將子查詢結果的記錄資料新增至INSERT子句的資料表。

* 因為SELECT子查詢是取代VALUES子句，所以 取得欄位值需對應插入記錄的欄位清單。 

從【通訊錄】資料表取得記錄來新增至【學生】資料表，如下所示： 
```
INSERT INTO 學生  
SELECT 學號, 姓名, 性別, 電話, 生日 
FROM 通訊錄 
```


### SELECT INTO指令

* SELECT INTO指令是T-SQL語言的擴充指令，可以使用查詢結果來建立一個新的資料表，其基本語法如下所示： 
```
SELECT 欄位清單
INTO 新資料表名稱 
FROM 資料表來源 
[WHERE 搜尋條件] 
[GROUP BY 欄位清單] 
[HAVING 搜尋條件] 
[ORDER BY 欄位清單]
```

建立【課程】資料表的部分備份，即新增名為【課程備份2】資料表，如下所示： 
```
SELECT * INTO 課程備份2 
FROM 課程 
WHERE 學分 = 3
```

# 更新紀錄

### UPDATE指令

* UPDATE指令可以將資料表符合條件的記錄，更新其指定欄位的內容，而且能夠同時更新多筆記錄，其基本語法如下所示：
```
UPDATE 資料表名稱 
SET 欄位名稱1 = 新欄位1      
 [, 欄位名稱2 = 新欄位2] 
[FROM 資料來源] 
[WHERE 更新條件] 
```
在【課程】資料表使用算術運算式更改課程編號 CS410 的學分數，如下所示：
```
UPDATE 課程 
SET 學分 = 學分 + 1 
WHERE 課程編號 = 'CS410' 
```

###  合併更新

在【班級】資料表更新【科系】欄位為 CIS 且在教室300-K上課的時間，將時間改為9:00am，如下所示： 
```
UPDATE 班級 
SET 班級.上課時間 = ‘9:00am’ 
FROM 班級 INNER JOIN 教授  
ON 班級.教授編號 = 教授.教授編號  
WHERE 教授.科系 = ‘CIS’ AND 班級.教室 = ‘300-K’ 
```

在完成Ch10_3_3_01.sql的合併更新後，我們可以執行SELECT指令顯示【班級】資料表的所有記錄和欄位，如下所示： 
```
SELECT 教授編號, 學號, 課程編號, 教室,      
  DATEPART(Hour, 上課時間) AS 上課時間 
FROM 班級 
```


# 刪除紀錄

### DELETE指令 

* DELETE指令可以將資料表符合條件的記錄刪除掉，其基本語法如下所示： 
```
DELETE [FROM] 資料表名稱 
[FROM 資料來源] 
[WHERE 刪除條件] 
```

在【學生】資料表刪除學號S108的學生記錄，如下所示： 
```
DELETE FROM 學生 
WHERE 學號 = 'S108' 
```

### TRUNCATE TABLE指令

* 如果想刪除整個資料表的記錄，但是保留資料表 的定義資料，我們可以使用 TRUNCAT TABLE 指令刪除資料表的內容，其基本語法如下所示： 
`TRUNCATE TABLE 資料表名稱`

刪除【課程備份】資料表內容，如下所示： 
`TRUNCATE TABLE 課程備份`

### MERGE指令
